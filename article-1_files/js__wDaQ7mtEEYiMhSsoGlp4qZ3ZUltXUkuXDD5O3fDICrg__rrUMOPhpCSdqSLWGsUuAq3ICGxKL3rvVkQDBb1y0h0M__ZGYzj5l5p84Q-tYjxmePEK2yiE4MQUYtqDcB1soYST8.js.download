(function(a){Drupal.behaviors.highwire_access_indicator={attach:function(i,c){var s=[];$access_icons=a('span.highwire-citation-access-check, span.highwire-citation-pdf-download');$access_icons.each(function(){var i={pisa_id:a(this).closest('[data-pisa-id]').data('pisa-id'),apath:a(this).closest('[data-apath]').data('apath'),view:a(this).data('request-view'),};if(a(this).data('claim-seat-license')=='yes'){i['claim_seat_license']=a(this).data('claim-seat-license')};s.push(i)});if(s.length>0){a.ajax({url:'/highwire/articlecitation/ac',type:'POST',data:{'items':s},success:function(i){$access_icons.each(function(t){var s=a(this),h=a(this).closest('[data-pisa-id]').data('pisa-id'),n=a(this).closest('[data-apath]').data('apath'),c=s.data('request-view');if(h){var e=h+'||'+c}
else if(n){var e=n+'||'+c};if(i[e]['access'][c]!=undefined&&i[e]['access'][c]==!0){if(s.hasClass('highwire-citation-access-check')){s.children('.highwire-access-icon-user-access').show();s.children('.highwire-access-icon-no-access').hide()}
else if(s.hasClass('highwire-citation-pdf-download')){s.show()}}
else{s.children('.highwire-access-icon-no-access').show();s.children('.highwire-access-icon-user-access').hide()}})},})}}}}(jQuery));(function(a){if(a().jquery.split('.')[0]=='1'&&parseInt(a().jquery.split('.')[1])<6){if(typeof console=='object'){console.error('Panels Ajax Tab Error: jQuery 1.6 or higher required.')}};window.onpopstate=function(t){if(t.state!=null){a('a[data-panel-name="'+t.state.tab+'"]').panels_ajax_tabs_trigger()}};Drupal.behaviors.panels_ajax_tabs={attach:function(t){a('.panels-ajax-tab-tab',t).once('panels-ajax-tabs-once',function(){if(a(this).parent().hasClass('active')&&a(this).data('url-enabled')==1){if(typeof window.history.pushState!='undefined'){window.history.replaceState({'tab':a(this).data('panel-name')},a(this).html(),window.location.href)}};a(this).click(function(t){t.preventDefault();if(typeof window.history.pushState!='undefined'&&a(this).data('url-enabled')==1){var e=a(this).attr('href')?a(this).attr('href'):location.pathname;window.history.pushState({'tab':a(this).data('panel-name')},a(this).html(),e)};if(!a(this).parent().hasClass('active')){a(this).panels_ajax_tabs_trigger()}}).css('cursor','pointer')});a('.pane-panels-ajax-tab-tabs',t).once('panels-ajax-tabs-once',function(){var i=a('.panels-ajax-tab-tab:not(.panels-ajax-tabs-first-loaded)',this),e=i.first(),r=e.data('target-id'),n=a('#panels-ajax-tab-container-'+r).data('panels-ajax-tab-preloaded'),t;if(n===''){t=e;e.trigger('click')}
else{t=i.filter('*[data-panel-name="'+n+'"]')};t.addClass('panels-ajax-tabs-first-loaded');t.parent().addClass('active')})}}})(jQuery);(function(a){a.fn.extend({panels_ajax_tabs_trigger:function(t){return this.each(function(){var e=a(this),r=e.parents('.panels-ajax-tab:first');if(a(r).data('loading')===!0){return!0};a(r).data('loading',!0);var n=e.data('target-id'),i=e.data('panel-name'),c=e.data('entity-context'),p=e.data('url-enabled'),h=e.data('trigger'),l={tab:this,tabObject:e,containerId:'#panels-ajax-tab-container-'+n,callback:t,cache:!1,};var s=a.Event('panelsAjaxTabsPreLoad',l),d=a.Event('panelsAjaxTabsPreBehavior',l),o=a.Event('panelsAjaxTabsLoaded',l);if(a('#panels-ajax-tab-container-'+n).children('.panels-ajax-tab-wrap-'+i).length){s.cached=!0;a(document).trigger(s,s.data);a('#panels-ajax-tab-container-'+n).children().hide();a('#panels-ajax-tab-container-'+n).children('.panels-ajax-tab-wrap-'+i).show();a(r).data('loading',!1);if(t){t.call(this,e)};o.cached=!0;a(document).trigger(o)}
else{a.ajax({url:Drupal.settings.basePath+'panels_ajax_tab/'+i+'/'+c+'/'+p+'?panels_ajax_tab_trigger='+h+'&panels_ajax_tab_tab='+i,datatype:'html',headers:{'X-Request-Path':document.location.pathname},cache:!1,beforeSend:function(t){a(document).trigger(s);a('#panels-ajax-tab-container-'+n).children().hide();a('#panels-ajax-tab-container-'+n).children('.panels-ajax-tab-loading').show()},error:function(t,n,e){if(typeof console=='object'){console.error('Panels Ajax Tab Error: '+e)};a(r).data('loading',!1)}}).done(function(s){a('#panels-ajax-tab-container-'+n).children('.panels-ajax-tab-loading').hide();a('#panels-ajax-tab-container-'+n).append('<div class="panels-ajax-tab-wrap-'+i+'">'+s['markup']+'</div>');a(document).trigger(d,d.data);Drupal.attachBehaviors(a('#panels-ajax-tab-container-'+n+' .panels-ajax-tab-wrap-'+i)[0]);a(r).data('loading',!1);if(t){t.call(this,e)};a(document).trigger(o)})};e.parent().siblings().removeClass('active');e.parent().addClass('active')})}})})(jQuery);(function(i){Drupal.behaviors.bmjjAffiliatesToggle={attach:function(t,l){if(i('.article .contributors .affiliation-list').length){i('.article .contributors .affiliation-list',t).once('bmjj-author-affiliates',function(){i('.article .contributors:last ol.affiliation-list, .article .contributors:last ol.corresp-list').wrapAll('<div class=\'toggle-group\' />');if(i(this).find('li.aff').length>1){i('.article.author-affiliates .contributors').addClass('multi-affiliation')};var t=i('.toggle-group');t.hide();i('<h2 class="pane-title ctools-collapsible-handle affiliation-list-reveal">Author affiliations<svg class="icon-plus"><use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#icon-plus"></use></svg></h2>').insertBefore(t);i('.article .contributors:last h2.affiliation-list-reveal').click(function(){var l=i(this);if(t.css('display')=='none'){l.find('svg').attr('class','icon-close');l.find('use').attr('xlink:href','#icon-close')}
else{l.find('svg').attr('class','icon-plus');l.find('use').attr('xlink:href','#icon-plus')};t.slideToggle();return!1})})}}}})(jQuery);